<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>bashtxt</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#shell-libraries" id="toc-shell-libraries">Shell
Libraries</a></li>
<li><a href="#preface" id="toc-preface">Preface</a></li>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#shell-functions-how-to-write-save-re-use"
id="toc-shell-functions-how-to-write-save-re-use">Shell Functions, How
To Write, Save, Re-use</a>
<ul>
<li><a href="#write-a-shell-function"
id="toc-write-a-shell-function">Write a Shell Function</a>
<ul>
<li><a href="#hello-world" id="toc-hello-world">Hello World</a></li>
<li><a href="#more-interesting" id="toc-more-interesting">More
interesting</a></li>
</ul></li>
<li><a href="#use-function-arugments"
id="toc-use-function-arugments">Use Function Arugments</a>
<ul>
<li><a href="#the-first-argument" id="toc-the-first-argument">The first
argument</a></li>
</ul></li>
<li><a href="#introduing-shell-syntax-the-for-loop"
id="toc-introduing-shell-syntax-the-for-loop">Introduing Shell Syntax,
the For Loop</a>
<ul>
<li><a href="#individual-arugments"
id="toc-individual-arugments">Individual Arugments</a></li>
<li><a href="#next-steps" id="toc-next-steps">Next Steps</a></li>
</ul></li>
<li><a href="#inspect-a-function-body"
id="toc-inspect-a-function-body">Inspect a Function Body</a>
<ul>
<li><a href="#more-about-arguments" id="toc-more-about-arguments">More
about arguments</a></li>
<li><a href="#experiments" id="toc-experiments">experiments</a></li>
<li><a href="#questions" id="toc-questions">questions</a></li>
<li><a href="#the-function-body" id="toc-the-function-body">The function
body</a></li>
<li><a href="#assesment" id="toc-assesment">assesment</a></li>
</ul></li>
<li><a href="#loop-with-foreach" id="toc-loop-with-foreach">Loop with
Foreach</a>
<ul>
<li><a href="#the-for-loop" id="toc-the-for-loop">The For loop</a></li>
<li><a href="#the-for-syntax" id="toc-the-for-syntax">The /for/
syntax</a></li>
<li><a href="#the-foreach-function" id="toc-the-foreach-function">The
foreach function</a></li>
<li><a href="#questions-1" id="toc-questions-1">questions:</a></li>
</ul></li>
<li><a href="#collect-save-and-reuse"
id="toc-collect-save-and-reuse">Collect Save and Reuse</a>
<ul>
<li><a href="#accessing-a-function-library"
id="toc-accessing-a-function-library">Accessing a Function
Library</a></li>
<li><a href="#writing-your-first-function-library"
id="toc-writing-your-first-function-library">Writing your first Function
Library</a></li>
</ul></li>
<li><a href="#introduced-in-this-chapter"
id="toc-introduced-in-this-chapter">Introduced in this Chapter</a>
<ul>
<li><a href="#commands-and-features"
id="toc-commands-and-features">Commands and Features</a></li>
<li><a href="#functions" id="toc-functions">Functions</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul></li>
<li><a href="#comment-hiding" id="toc-comment-hiding">COMMENT
hiding…</a>
<ul>
<li><a href="#accessing-a-function-library-1"
id="toc-accessing-a-function-library-1">Accessing a Function
Library</a></li>
<li><a href="#introduced-in-this-chapter-1"
id="toc-introduced-in-this-chapter-1">Introduced in this
Chapter</a></li>
<li><a href="#commands-and-features-1"
id="toc-commands-and-features-1">Commands and Features</a></li>
<li><a href="#functions-1" id="toc-functions-1">Functions</a></li>
</ul></li>
</ul></li>
<li><a href="#a-brief-history-of-shell-commands"
id="toc-a-brief-history-of-shell-commands">A Brief History of Shell
Commands</a>
<ul>
<li><a href="#new-concepts" id="toc-new-concepts">New Concepts</a></li>
<li><a href="#shell-command-history"
id="toc-shell-command-history">Shell Command History</a></li>
<li><a href="#history-list" id="toc-history-list">history list</a></li>
<li><a href="#the-simple-step-the-function"
id="toc-the-simple-step-the-function">The simple step – the
function</a></li>
<li><a href="#terminal-cut-and-paste"
id="toc-terminal-cut-and-paste">Terminal Cut and Paste</a></li>
<li><a href="#review" id="toc-review">Review</a></li>
</ul></li>
<li><a href="#shdoc-shell-doc-comments"
id="toc-shdoc-shell-doc-comments">Shdoc – SHell DOC comments</a>
<ul>
<li><a href="#new-concepts-1" id="toc-new-concepts-1">New
Concepts</a></li>
<li><a href="#the-null-command" id="toc-the-null-command">the Null
Command</a></li>
<li><a href="#now-the-function-documentation"
id="toc-now-the-function-documentation">Now the Function
Documentation</a>
<ul>
<li><a href="#the-first-functions" id="toc-the-first-functions">the
first functions</a></li>
<li><a href="#comment-hide-some-functions-for-later"
id="toc-comment-hide-some-functions-for-later">COMMENT Hide some
functions for later</a></li>
</ul></li>
<li><a href="#embedding-a-modification-date"
id="toc-embedding-a-modification-date">Embedding a Modification
Date</a></li>
<li><a href="#the-date-is-our-first-tag"
id="toc-the-date-is-our-first-tag">The Date is Our First Tag</a>
<ul>
<li><a href="#the-shell-documentation"
id="toc-the-shell-documentation">The Shell Documentation</a></li>
<li><a href="#functions-abstracts"
id="toc-functions-abstracts">Functions Abstracts</a></li>
</ul></li>
<li><a href="#building-the-function-database"
id="toc-building-the-function-database">Building the Function
Database</a>
<ul>
<li><a href="#functions-yet-to-define"
id="toc-functions-yet-to-define">Functions yet to define</a></li>
</ul></li>
<li><a href="#awk-digression" id="toc-awk-digression">awk
digression</a></li>
<li><a href="#activity" id="toc-activity">Activity</a></li>
<li><a href="#references-1" id="toc-references-1">References</a></li>
</ul></li>
<li><a href="#collecting-functions"
id="toc-collecting-functions">Collecting Functions</a>
<ul>
<li><a href="#families" id="toc-families">Families</a>
<ul>
<li><a href="#names" id="toc-names">names</a></li>
<li><a href="#generic-sub-functions-e.g.-_init"
id="toc-generic-sub-functions-e.g.-_init">generic sub-functions,
e.g. _init</a></li>
</ul></li>
<li><a href="#types-of-libraries" id="toc-types-of-libraries">Types of
Libraries</a>
<ul>
<li><a href="#system-low-level" id="toc-system-low-level">system,
low-level</a></li>
<li><a href="#application-oriented"
id="toc-application-oriented">application oriented</a></li>
<li><a href="#collection-plate" id="toc-collection-plate">collection
plate</a></li>
</ul></li>
<li><a href="#collecting-into-applications"
id="toc-collecting-into-applications">Collecting into
Applications</a></li>
</ul></li>
<li><a href="#assertion-checking" id="toc-assertion-checking">Assertion
checking</a></li>
<li><a href="#development-process"
id="toc-development-process">Development Process</a>
<ul>
<li><a href="#using-backup" id="toc-using-backup">using Backup</a></li>
<li><a href="#how-frequently-take-a-version"
id="toc-how-frequently-take-a-version">how frequently take a
“version”</a></li>
<li><a href="#shdoc-tags-prep-for-function-data-base"
id="toc-shdoc-tags-prep-for-function-data-base">shdoc, tags, prep for
Function Data base</a></li>
<li><a href="#dp-cycle-in-one-principle-library-with-others"
id="toc-dp-cycle-in-one-principle-library-with-others">DP, Cycle in One
Principle library, with others</a></li>
</ul></li>
<li><a href="#debugging" id="toc-debugging">Debugging</a></li>
<li><a href="#dot-prof-the-dp-command"
id="toc-dot-prof-the-dp-command">Dot Prof, the DP command</a>
<ul>
<li><a href="#sections-of-the-dot-prof-file."
id="toc-sections-of-the-dot-prof-file.">Sections of the Dot Prof
file.</a>
<ul>
<li><a href="#sources" id="toc-sources">sources</a></li>
<li><a href="#functions-2" id="toc-functions-2">functions</a></li>
</ul></li>
<li><a href="#top-functions" id="toc-top-functions">Top Functions</a>
<ul>
<li><a href="#solo" id="toc-solo">Solo</a></li>
<li><a href="#home" id="toc-home">Home</a></li>
</ul></li>
<li><a href="#used-functions" id="toc-used-functions">Used
Functions</a></li>
</ul></li>
<li><a href="#a-database-for-functions"
id="toc-a-database-for-functions">A Database for Functions</a>
<ul>
<li><a href="#the-architecture" id="toc-the-architecture">the
Architecture</a></li>
<li><a href="#access" id="toc-access">Access</a>
<ul>
<li><a href="#adding-to-the-database"
id="toc-adding-to-the-database">adding to the database</a></li>
<li><a href="#removing-from-the-databas"
id="toc-removing-from-the-databas">removing from the databas</a></li>
<li><a href="#querying-the-database"
id="toc-querying-the-database">querying the database</a></li>
</ul></li>
</ul></li>
<li><a href="#factor-a-shell-script"
id="toc-factor-a-shell-script">Factor a Shell Script</a></li>
<li><a href="#system-tools" id="toc-system-tools">System Tools</a>
<ul>
<li><a href="#awk" id="toc-awk">Awk</a>
<ul>
<li><a href="#in-functions-size-objective"
id="toc-in-functions-size-objective">in functions, size
objective</a></li>
</ul></li>
<li><a href="#sed-grep" id="toc-sed-grep">Sed, Grep</a></li>
</ul></li>
<li><a href="#applications" id="toc-applications">Applications</a>
<ul>
<li><a href="#rdb" id="toc-rdb">/RDB</a></li>
<li><a href="#backup" id="toc-backup">Backup</a></li>
<li><a href="#tags" id="toc-tags">Tags</a></li>
<li><a href="#function-data-base" id="toc-function-data-base">Function
Data Base</a></li>
</ul></li>
<li><a href="#comment-the-invariants"
id="toc-comment-the-invariants">COMMENT The Invariants</a>
<ul>
<li><a href="#a-place-to-collect-the-short-separated"
id="toc-a-place-to-collect-the-short-separated">A place to collect the
short, separated</a></li>
<li><a href="#shibboleth-rebuttal"
id="toc-shibboleth-rebuttal">shibboleth rebuttal</a></li>
<li><a href="#publication-plans" id="toc-publication-plans">publication
plans</a>
<ul>
<li><a
href="#todo-resurrect-the-2107-edition-of-m_c_wagon-to-mcorg-eschew-wp"
id="toc-todo-resurrect-the-2107-edition-of-m_c_wagon-to-mcorg-eschew-wp">TODO
resurrect the 2107 edition of m_c_wagon to McOrg, eschew WP</a></li>
</ul></li>
</ul></li>
<li><a href="#appendices" id="toc-appendices">Appendices</a>
<ul>
<li><a href="#the-script" id="toc-the-script">The Script</a>
<ul>
<li><a href="#the-app_script" id="toc-the-app_script">the
app_script</a></li>
<li><a href="#an-actual-sh-bang" id="toc-an-actual-sh-bang">an actual
sh-bang</a></li>
<li><a href="#the-only-sh-bang-youll-ever-need"
id="toc-the-only-sh-bang-youll-ever-need">the only sh-bang you’ll ever
need</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="shell-libraries">Shell Libraries</h1>
<p>This book //Shell Libraries// picks up an earlier ebook: <a
href="https://leanpub.com/shellfunctions">Shell Functions</a>, which
isincluded here, a the chapter introducing “how-to – create, save, and
re-use” <a
href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">bashshell</a>
functions. Each chapter has worked examples built on prior information,
introducing new concepts, each thoroughly discussed, and assessed for
understanding. The theme of the book is introduced in writing a few
shell functions which are then collected into a simple library. The
goal, as one’s repertoire of functions grows, is to recognize which
functions belong in the same library.</p>
<h1 id="preface">Preface</h1>
<p>This book builds on the ability to store and re-use shell functions
from a library, and advances the idea of storing functions in separate
libraries. While it’s possible to put every function in one library,
you’ll soon come to realize it’s both unwieldy and more difficult to
maintain. In my experience functions collect towards higher level use
(applications) and lower level features (debugging, assertion checking,
file and process handling, … )</p>
<p>Then, if there is an application to be advanced in this book, it’s
the shell function development environment. In the Unix world, tools are
purposely small, single - purpose, and made more powerful by their
ability to connect to one another. No book on the shell is complete
without reference to a particular handful of sharp tools, notably awk,
grep, and sed.</p>
<p>An application I have found useful over the years, is a too-little
used data-base /RDB, whose data, including numbers, is stored in
line-oriented text files. /RDB is built mostly on a combination of awk
and the shell. It will have its own library here.</p>
<p>Two words of caution are in order. First a bit of self-criticism.
Some of my function libraries, when raised to an application, suggest
implementing in a higher-level language. I’m thinking of python here,
since I have done enough to realize its connection to databases. We’ll
come across a few functions using a python or a Perl script.</p>
<p>The other word of caution is, if you’re looking for how to write a
bash shell script, that’s defered to later in the book. Most instruction
on shell programming starts with an early lesson on “scripting”. A hope
of this book is to raise the craft of shell scripting to a profession of
shell programming.</p>
<h1 id="introduction">Introduction</h1>
<p>To proceed, the next chapter assumes you:</p>
<ul>
<li><p>have an account on a computer with a terminal</p></li>
<li><p>as an alternative, go to the <a
href="https://cloud.google.com/shell">Google Cloud Shell</a>; follow the
link to the console.</p></li>
<li><p>have worked exercises in a shell tutorial such <a
href="https://www.shellscript.sh/">as here</a>.</p></li>
<li><p>for now, you do not need access to a file editor such as vi(m),
emacs, nano, ed, …</p></li>
<li><p>but will soon.</p></li>
</ul>
<p>This is not a shell tutorial. We are here to advance the use of shell
functions, and collect them into function libraries. System commands and
features are fully referenced when introduced. For example, the shell
syntax for</p>
<ul>
<li>decision ( if - then - else )</li>
<li>repetition ( for, while ) and</li>
<li>selection ( case .. of .. esac )</li>
</ul>
<p>are introduced in the context of a function,</p>
<p>Before proceeding, you may want to consult the authoritative source
on <a
href="https://www.gnu.org/software/bash/manual/html_node/Shell-Functions.html">Shell
Functions</a> /here, insert a summary of the sequence to follow/</p>
<h1 id="shell-functions-how-to-write-save-re-use">Shell Functions, How
To Write, Save, Re-use</h1>
<p>We’ll start by composing and executing functions on the command line,
without recourse to a text editor.</p>
<p>The functions we’ll write in this chapter are short enough to fit on
a single line. As you get more comfortable writing on the command line,
expect to write functions extending and wrapping text on the terminal.
At some point, you will need an editor to write and maintain
functions.</p>
<p>This chapter is the updated e-book – <a
href="https://leanpub.com/shellfunctions">Shell Functions</a>. Each
section of this chapter is simple enough to require a half an hour of
your time. When you’ve completed these exercises, you will be
comfortable creating, using, saving and re-using shell functions.</p>
<p>To get started, here are the few assumptions we make. That you:</p>
<ul>
<li>have access to an open terminal window</li>
<li>can open simultaneous multiple terminal windows</li>
<li>are running the bash shell</li>
</ul>
<p>The text is sprinkled with links to more detailed treatment of
fundamental topics. Each chapter offers suggestions with experiments
which when followed will enable the curious reader to grasp the
concepts.</p>
<h2 id="write-a-shell-function">Write a Shell Function</h2>
<p>The simplest shell functions may be written on a single line at the
command prompt. In this chapter, you will write and use two simple shell
functions: <code>hello</code> and <code>today</code>.</p>
<h3 id="hello-world">Hello World</h3>
<p>In this chapter, and throughout the book, you may assume your command
prompt is the dollar sign when entered at the command line.</p>
<pre><code>
    $ ...
</code></pre>
<p>The /Programmer’s Birth Announcement/ is <em>Hello World!</em> Type
this after your command prompt:</p>
<pre><code>    : define the hello function
    hello () { echo &quot;Hello World!&quot;; }
    
    : view the function stored in the shell memory
    declare -f hello
    
    : using it, in action
    hello
    
    : where the Results are here
    : --------------------------</code></pre>
<p>To work this example, enter each of the un-commented lines, those
with no leading colon(:), followed by a carriage return. In order, you
are:</p>
<ul>
<li>defining the function</li>
<li>seeing how it is stored, and</li>
<li>using it, in action</li>
</ul>
<p>You can see the formal definition of a function from the //declare//
builtin. After typing =declare -f hello=, you then typed the function
name =hello=, executing the function. You see both results at the
end.</p>
<p>The declared version of your function has been slightly reformatted.
More on that later.</p>
<h3 id="more-interesting">More interesting</h3>
<p>Arguments, like file names and options make functions more useful.
But before looking at how arguments are used, whet your appetite with
this one, called =today=</p>
<p>#+begin_src bash :exports both :results output today () { date
+%Y%m%d; } declare -f today today : ————– #+end_src</p>
<p>Type the definition and invoke your new function =today=. Since
//date// takes almost any upper- or lower-case letter, we’ll deal with
those later as arguments. Here’s a search for <a
href="https://www.unix.com/man-page/Linux/1/date/">Unix Date Man
Page</a>.The FORMAT arguments appear after the plus (+) sign.</p>
<dl>
<dt>You’ll probably deduce these assignments:</dt>
<dd>
<p>%Y four digit year</p>
</dd>
<dd>
%m two digit month
</dd>
<dd>
%d two digit date
</dd>
</dl>
<h2 id="use-function-arugments">Use Function Arugments</h2>
<p>In the last exercise you used the =date= command in a function – in a
very limited way. You saw the date command with upper- and lower-case
options. Without going in great detail, a date option is a plus sign (+)
followed by any number of percent sign - single letter pairs. The format
may contain any text; be sure to quote an argument which has embedded
spaces. e.g.:</p>
<p>#+begin_src bash :exports both :results output</p>
<dl>
<dt>date “+%a %b … and some message”</dt>
<dd>
<hr />
#+end_src
</dd>
</dl>
<h3 id="the-first-argument">The first argument</h3>
<p>In this exercise, you will write a helper function to remind you what
each of the many options return. e.g. /what does “date +%a” return/, and
so forth. Your function will display the letter argument, and the “date”
result of using it.</p>
<p>Since the <em>date</em> command permits a formatting option, you
might have done this:</p>
<p>#+begin_src bash :exports both :results output</p>
<dl>
<dt>date “+Y: %Y”</dt>
<dd>
<hr />
#+end_src
</dd>
</dl>
<p>Now, let’s replace the specific <em>option</em> parameters with a
<em>positional parameter</em>, and call the function with an
<em>argument</em></p>
<p>#+begin_src bash :exports both :results output dateArg () { date
“+$1: %$1”; } : omit the declaration, call with a few arguments dateArg
c dateArg F</p>
<p>: ————– #+end_src</p>
<p>Note that the /c/ and /F/ arguments are a composite option, each
printing a useful representation of the date.</p>
<h2 id="introduing-shell-syntax-the-for-loop">Introduing Shell Syntax,
the For Loop</h2>
<p>With the strong hint there’s quite a bit of information hidden behind
the upper- and lower-case paramters to the date command, lets see if we
can easily give ourselves a reminder.</p>
<p>/*</p>
<pre><code>for var in list ; do command(s) using var ... ; done</code></pre>
<p>*/</p>
<p>The syntax elements in that statememt:</p>
<p><em>for</em> … <em>in</em> <em>; do</em> … <em>; done</em></p>
<p>where the /var/ becomes a shell variable name, which is any
alphanumeric) and invoked as /$var/ the “value” of the variable and the
/command/s are</p>
<ul>
<li>built-in shell commands,</li>
<li>excutable file commands,</li>
<li>defined functions, and</li>
<li>commands with input/output direction</li>
</ul>
<p>any of the commands may take arguments, and multiple commands must be
separated with semi-colons. /do/ and /done/ may appear on separate lines
in a function, which remove the need for a separating semi.colon</p>
<h3 id="individual-arugments">Individual Arugments</h3>
<p>#+begin_src bash :exports both :results output dateArg () { date
“+$1: %$1”; } for opt in a c d F Y; do dateArg $opt; done : ———-
#+end_src</p>
<p>The for loop assigns the separate arguments in sequence to the shell
variable, evaluated as the one positional paramenter of the
=dateArg=.</p>
<p>#+begin_src bash :exports both :results output</p>
<p>#+end_src</p>
<p>Of special note are the ‘’n’’ and ‘’t’’ arguments. You can likely
distinguish their meaning.</p>
<p>Now, some of your explanations come easier. Since the day, the hour
or the minutes many be the same number, some letter options may give the
same result, and therefore, still be ambiguous.</p>
<p>You’ve assigned the first positional parameter, and you can likely
figure out how to deal with the second, third, … etc. Also, notice, if
you haven’t done this before, you’ve just assigned and used a
<strong>shell variable</strong>, in this case the variable /opt/. You
assign it just by the name, and (in the for loop) substitute the value
with a leading dollar sign: <strong>$opt</strong>. So, in this case,
<strong>dateArg</strong> is invoked with each of the lower case letters
since the /{a..z}/ list expands into the list. Limited subsets are
possible, as are the Upper Case and numbers, which work as well:</p>
<p>/* 1 $ echo {10..13} 2 10 11 12 13 3 $</p>
<p>*/</p>
<p><strong>exercise:</strong></p>
<ul>
<li>run the example with the Upper Case letters.</li>
</ul>
<h3 id="next-steps">Next Steps</h3>
<p>Think about this using the latest example. How would you write a
<strong>foreach</strong> function to simplify the whole command to
this:</p>
<pre><code>foreach dateArg {a..z}</code></pre>
<h2 id="inspect-a-function-body">Inspect a Function Body</h2>
<p>In this section, you will:</p>
<ul>
<li>use wild-card parameters</li>
<li>use numeric parameters</li>
<li>use default parameters</li>
<li>evaluate a deferred expression</li>
<li>set positional parameters</li>
<li>create a function to display functions</li>
</ul>
<p>Recall, in a <a href="Getting%20it%20right">previous section</a>, you
were asked /what would you name a function to display a Function
BoDY/?</p>
<p>I think we’ll call it <strong>fbdy</strong>.</p>
<p>To review:</p>
<p>/* 1 $ declare -f hello 2 hello () 3 { 4 echo “hello world” 5 } 6
$</p>
<p>*/</p>
<p>By the way, if you’ve logged off and logged back in since the
previous section, you’ve lost the function definition and will have to
re-enter it. In a future exercise, you will learn a simple means to
recover your work from day-to-day, session-to-session.</p>
<h3 id="more-about-arguments">More about arguments</h3>
<p>To this point, we have only used the first positional parameter; here
we see how to refer to individual arguments, something more than the
successive parameters in an argument list.</p>
<p>In addition to the numbered positional parameters: 1, 2, 3, … you
will learn of other parameter features. Introductory features express
all positional parameters, report the number of positional parameters,
and assigning a default value to a positional parameter. So here’s how
to set positional parameters.</p>
<p>Enter these commands</p>
<p>/* 1 set a b c # set 3 positional parameters to a b c 2 echo $@ #
show them 3 echo $# # how many? 4 echo here is One: <span
class="math inline">15<em>e</em><em>v</em><em>a</em><em>l</em><em>e</em><em>c</em><em>h</em><em>o</em><em>h</em><em>e</em><em>r</em><em>e</em><em>i</em><em>s</em><em>t</em><em>h</em><em>e</em><em>l</em><em>a</em><em>s</em><em>t</em><em>o</em><em>n</em><em>e</em> : $</span>#
6 echo here is Two: $2 7 echo here is Two: ${2:-Two} 8 echo here is
Four: ${4:-four}</p>
<p>*/</p>
<p>Notice the use of /eval/ in the fifth example. At the end, /escape/
the first dollar sign, and the second one inserts the number of the last
parameter. The /eval/ defers the evaluation until the parameter
substitution is made. Therefore the /echo/ command sees “here is the
last one: $3”</p>
<p>Also note the # symbol. It sets off a shell comment. Shortly we’ll
introduce a more useful means, and note the reason why.</p>
<p>The last two steps demonstrate the use of the
<strong>default</strong> argument if the positional parameter is set on
not.</p>
<h3 id="experiments">experiments</h3>
<p>Experiment with other arguments to the set command.</p>
<p>/*</p>
<p>$ set - x # turns on command tracing $ … # execute some commands,
before you $ set +x # turn it off $ set +x a b c # also sets 3
parameters</p>
<p>*/</p>
<p>You may use a “set –” convention to set the positional parameters.
Though it’s not necessary. Experiment with other choices.</p>
<p>/*</p>
<p>$ set – one Two seven # replaces any previous setting, as does $ set
$3 four five # keep one, add others $ set $@ six seven # keep all, add a
few $ set one $@ # …</p>
<p>*/</p>
<h3 id="questions">questions</h3>
<p>In the examples, what do you understand:</p>
<ul>
<li>what the at sign ’‘($@)’’ means?</li>
<li>what the sharp/hash ’‘($#)’’ means?</li>
<li>what does the /eval/ command do? hint: omit it from the command
line.</li>
</ul>
<p>In the next section we will see ho to use the positional parameters
within a function.</p>
<h3 id="the-function-body">The function body</h3>
<p>You can take advantage of this information to write a function that
returns a function. As you write this function, think of /what is a good
<strong>default</strong> argument?/ Enter these, a line at a time:</p>
<p>/* 1 $ declare -f hello # as before 2 $ fbdy () { declare -f $1; } #
the simple version 3 $ fbdy hello # same as before 4 $ fbdy fbdy # no
kidding!, so why not … 5 $ fbdy () { declare -f ${1:-fbdy}; } # so … 6 $
fbdy # shows how to do it!, and 7 $ fbdy () { declare -f ${@:-fbdy}; } #
permits … 8 $ fbdy hello fbdy # whew, let’s take a break */</p>
<p>Note, to this point we have not had to use an editor to compose the
few functions we’ve introduced. It’s a useful feature, but not one we’ll
push to extremes.</p>
<p>At step 5, we introduced the notion of a /convenient default/. The
idea of a convenient default is to /self-document/ a function. This one
is so simple, with a so-suggestive name, it’s prime value is to
introduce the technique, with increasing payback over time.</p>
<p>Not the changes from steps 5 thru 8. This time the introduction of
the wild-card /all the arguments/. Take every opportunity to use that
feature. Only restricting to specific arguments when necessary.</p>
<p>**** questions</p>
<ul>
<li>were you able to follow each step?</li>
<li>what does the final <strong>fbdy</strong> do with no arguments?</li>
</ul>
<h3 id="assesment">assesment</h3>
<p>Review if necessary, your understanding of</p>
<ul>
<li>wild-card parameters</li>
<li>default parameters</li>
<li>setting positional parameters</li>
<li>how the function body is displayed. hint: search /bash shell
declare/</li>
</ul>
<p>**** COMMENT add the forward reference 5-8 to if_missingargs</p>
<h2 id="loop-with-foreach">Loop with Foreach</h2>
<h3 id="the-for-loop">The For loop</h3>
<p>Our first control syntax item is the =for= loop. Here the syntax is
given by the elements</p>
<ul>
<li>=for=</li>
<li>=in=</li>
<li>=; do=</li>
<li>and =; done=</li>
</ul>
<p>as here:</p>
<p>for /var/ in /list/ ; do /command(s) using $var …/ ; done</p>
<p>This example suffices, demonstrating our first</p>
<ul>
<li>shell variable: /$opt/</li>
<li>used a a /function argument/,</li>
<li>setting a /positional parameter/.</li>
</ul>
<p>The variable name /opt/ is retreived by value with a /$opt/, passed
as the first argument to the =dateArg= function, and used twice in that
function to show the argument value, =$1:= and the effect of the =date=
command to accept the formatting option. =+ … %=.</p>
<hr />
<p>Of special note are the ‘’n’’ and ‘’t’’ arguments. You can likely
distinguish their meaning.</p>
<p>Now, some of your explanations come easier. Since the day, the hour
or the minutes many be the same number, some letter options may give the
same result, and therefore, still be ambiguous.</p>
<p>You’ve assigned the first positional parameter, and you can likely
figure out how to deal with the second, third, … etc. Also, notice, if
you haven’t done this before, you’ve just assigned and used a
<strong>shell variable</strong>, in this case the variable /opt/. You
assign it just by the name, and (in the for loop) substitute the value
with a leading dollar sign: <strong>$opt</strong>. So, in this case,
<strong>dateArg</strong> is invoked with each of the lower case letters
since the /{a..z}/ list expands into the list. Limited subsets are
possible, as are the Upper Case and numbers, which work as well:</p>
<p>/* 1 $ echo {10..13} 2 10 11 12 13 3 $</p>
<p>*/</p>
<hr />
<p>Now you will work with the /for/ syntax to produce a
<strong>foreach</strong> function that handles many loop
requirements.</p>
<p>You will use the built-in /shift/ command to control our positional
parameters, and the /local/ command to define a variable.</p>
<p>The shell has other useful looping constructs, namely the /while/
loop. Our focus here, the /for/ loop. The while loop is useful in
situations where the loop test may be more complicated than /is there
another argument to deal with?/ In this example, we will use a known
list of arguments, the for loop is appropriate.</p>
<p>You will use the for loop to write a function in a prior exercise
with function arguments, namely;</p>
<p>/* $ foreach dateArg {a..z} */</p>
<p>Recall the <strong>dateArg</strong> function;</p>
<p>/*</p>
<p>$ dateArg () { date “+$1: %$1”; }</p>
<p>*/</p>
<p>So, the reason for the foreach function should now be clear:</p>
<ul>
<li>execute the first argument, a function or command,</li>
<li>for each of the remaining arguments.</li>
</ul>
<p>The bash shell has the syntactic sugar /{a..z}/ to produce the lower
case letters as separate arguments in any command.</p>
<h3 id="the-for-syntax">The /for/ syntax</h3>
<p>Recall the earlier example with the <strong>dateArg</strong>
function:</p>
<pre><code>/for var in list... ; do command(s) using $var ...; done/</code></pre>
<p>specifically:</p>
<p>/*</p>
<p>$ for opt in {a..z}; do dateArg $opt; done</p>
<p>*/</p>
<p>If you don’t have your <strong>dateArg</strong> function handy,
re-enter it now. Then type the above command to execute it. Notice the
generic opt argument could be any relevant name. Also, notice the
position of the dateArg function; it is called once per lower-case
letter.</p>
<h3 id="the-foreach-function">The foreach function</h3>
<p>Enter this text to create your function and test it.</p>
<p>/*</p>
<p>foreach () { local cmd=“<span class="math inline">$1"; shift; for arg
in "$</span>@”; do $cmd $arg; done; } foreach dateArg a e i o u # a
purposely shorter list fbdy foreach dateArg */</p>
<p>Note the ease of displaying functions. Here are the results of those
commands.</p>
<p>/* foreach () { local cmd=$1; shift; for arg in $@; do $cmd $arg;
done; } foreach dateArg a e i o u a: Sun e: 30 i: i o: o u: 7 $ fbdy
foreach dateArg foreach () { local cmd=$1; shift; for arg in $@; do $cmd
$arg; done } dateArg () { date “+$1: %$1” } $ */</p>
<h3 id="questions-1">questions:</h3>
<ul>
<li>compare the <strong>foreach</strong> function with the /for/
command</li>
<li>notice the additional syntax in the function</li>
<li>explain what the /shift/ keyword does.</li>
<li>did you notice how the function body was displayed?</li>
<li>what is the meaning of the /local/ keyword</li>
</ul>
<h2 id="collect-save-and-reuse">Collect Save and Reuse</h2>
<p>Before we get ahead of ourselves lets use the tools we now have to
collect our functions, save them in a function library, and see how we
can re-us them in subsequent sessions on the computer.</p>
<p>Lets anticipate what we need to arrive at the last step.</p>
<h3 id="accessing-a-function-library">Accessing a Function Library</h3>
<p>The shell builtin, /source/ reads a <strong>file</strong> into the
current shell as if’s contents had been typed at the command line. We
already have the means to store our functions into a file, at this point
without having used a text editor. Nor will we have to use one just
yet.</p>
<p>I find it useful to store the functions in an executable file on your
PATH. When you login, you are running a terminal shell, in our case
/bash/. Confirm this by running this command:</p>
<p>/*</p>
<pre><code>$ echo $SHELL
/usr/local/bin/bash
$ ...</code></pre>
<p>*/</p>
<p>Which in this case is in the /usr/local/bin/ <em>directory</em>. If
you</p>
<p>/*</p>
<pre><code>$ echo $PATH
/Users/martymcgowan/bin:/Users/martymcgowan/git/dfg/bin: ....
...:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:...
$ ...</code></pre>
<p>*/</p>
<p>you see the directories on your PATH were you will find the
executable files. More later on selecting and adding directories to your
PATH. If you are on a well-administered system, your system
administrator will have set up a default PATH when you login.</p>
<p>I recommend you put your function library in a /./bin/ directory, and
personally use files whose name ends in /lib/. Prepare to store your
library:</p>
<p>/*</p>
<pre><code>$ mkdir $HOME/bin
$ PATH=$HOME/bin:$PATH    # put this in your ~/.bash_profile
$...</code></pre>
<p>*/</p>
<p>Where <strong>~</strong> is a shorthand for your /$HOME/
directory.</p>
<h3 id="writing-your-first-function-library">Writing your first Function
Library</h3>
<p>At last, the payoff. making you have the functions defined in your
current session. Just in case, here they are.</p>
<p>/* $ hello () { echo “Hello World!”; }</p>
<p>$ dateArg () { date “+$1: %$1”; } $ fbdy () { declare -f ${@:-fbdy};
} $ foreach () { local cmd=$1; shift; for arg in $@; do $cmd $arg; done;
} */</p>
<p>Enter them by typing on the command line. Now execute this
command:</p>
<p>/*</p>
<p>$ fbdy hello today dateArg fbdy foreach | tee $HOME/bin/ch01lib hello
() { echo “Hello World!” } today () { date +%Y%m%d } dateArg () { date
“+$1: %$1” } fbdy () { declare -f ${@:-fbdy} } foreach () { local
cmd=$1; shift; for arg in $@; do $cmd $arg; done } $ chmod +x
$HOME/bin/ch01lib</p>
<p>*/</p>
<p>The last command makes the file executable, so when you return, you
may</p>
<p>/*</p>
<p>$ source ch01lib # reading your functions into your shell */</p>
<h2 id="introduced-in-this-chapter">Introduced in this Chapter</h2>
<h3 id="commands-and-features">Commands and Features</h3>
<table>
<thead>
<tr class="header">
<th>command or concept</th>
<th>category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>chmod</td>
<td>command</td>
</tr>
<tr class="even">
<td>date</td>
<td>command</td>
</tr>
<tr class="odd">
<td>declare</td>
<td>shell builtin</td>
</tr>
<tr class="even">
<td>echo</td>
<td>command</td>
</tr>
<tr class="odd">
<td>eval</td>
<td>shell builtin</td>
</tr>
<tr class="even">
<td>file</td>
<td>object</td>
</tr>
<tr class="odd">
<td>for</td>
<td>shell keyword</td>
</tr>
<tr class="even">
<td>function</td>
<td>shell keyword</td>
</tr>
<tr class="odd">
<td>HOME</td>
<td>shell variable</td>
</tr>
<tr class="even">
<td>local</td>
<td>shell builtin</td>
</tr>
<tr class="odd">
<td>mkdir</td>
<td>command</td>
</tr>
<tr class="even">
<td>parameter expansion</td>
<td>concept</td>
</tr>
<tr class="odd">
<td>PATH</td>
<td>shell variable</td>
</tr>
<tr class="even">
<td>positional parameter</td>
<td>concept</td>
</tr>
<tr class="odd">
<td>set</td>
<td>shell builtin</td>
</tr>
<tr class="even">
<td>shell variable</td>
<td>object</td>
</tr>
<tr class="odd">
<td>shift</td>
<td>shell builtin</td>
</tr>
<tr class="even">
<td>source</td>
<td>shell builtin</td>
</tr>
<tr class="odd">
<td>tee</td>
<td>command</td>
</tr>
<tr class="even">
<td>unix manual page</td>
<td>object</td>
</tr>
<tr class="odd">
<td>———————-+—————-</td>
<td></td>
</tr>
</tbody>
</table>
<p>Help is close at hand:</p>
<p>/*</p>
<p>man chmod # for the concise details of a command (chmod) help -m for
# … of a shell keyword (for) or builtin man man # and help -m help # be
sure to read the Options</p>
<p>*/</p>
<h3 id="functions">Functions</h3>
<ul>
<li>dateArg</li>
<li>fbdy</li>
<li>foreach</li>
<li>hello</li>
<li>today</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li>bash shell https:/en.wikipedia.org/wiki/Bash_(Unix_shell)</li>
<li>date manual page https://duckduckgo.com/?q=unix+date+man+page</li>
<li>GNU Shell Functions
https://www.gnu.org/software/bash/manual/html_node/Shell-Functions.html</li>
<li>one sh-bang
https://mcgowans.org/pubs/marty3/commonplace/software/onlyOneShBang.html</li>
<li>shell builtin
[[https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html]]-
shell functions ebook https://leanpub.com/shellfunctions</li>
<li>shell keyword
[[https://www.gnu.org/software/bash/manual/html_node/Reserved-Word-Index.html]]-
shell tutorial https://www.shellscript.sh/</li>
<li>terminal shell https://cloud.google.com/shell</li>
</ul>
<h2 id="comment-hiding">COMMENT hiding…</h2>
<h3 id="accessing-a-function-library-1">Accessing a Function
Library</h3>
<h3 id="introduced-in-this-chapter-1">Introduced in this Chapter</h3>
<h3 id="commands-and-features-1">Commands and Features</h3>
<table>
<thead>
<tr class="header">
<th>command or concept</th>
<th>category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>date</td>
<td>command</td>
</tr>
<tr class="even">
<td>declare</td>
<td>shell builtin</td>
</tr>
<tr class="odd">
<td>echo</td>
<td>command</td>
</tr>
<tr class="even">
<td>eval</td>
<td>shell builtin</td>
</tr>
<tr class="odd">
<td>file</td>
<td>object</td>
</tr>
<tr class="even">
<td>for</td>
<td>shell keyword</td>
</tr>
<tr class="odd">
<td>function</td>
<td>shell keyword</td>
</tr>
<tr class="even">
<td>local</td>
<td>shell builtin</td>
</tr>
<tr class="odd">
<td>parameter expansion</td>
<td>concept</td>
</tr>
<tr class="even">
<td>PATH</td>
<td>shell variable</td>
</tr>
<tr class="odd">
<td>positional parameter</td>
<td>concept</td>
</tr>
<tr class="even">
<td>set</td>
<td>shell builtin</td>
</tr>
<tr class="odd">
<td>shell variable</td>
<td>object</td>
</tr>
<tr class="even">
<td>shift</td>
<td>shell builtin</td>
</tr>
<tr class="odd">
<td>source</td>
<td>shell builtin</td>
</tr>
<tr class="even">
<td>unix manual page</td>
<td>object</td>
</tr>
<tr class="odd">
<td>———————-+—————-</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="functions-1">Functions</h3>
<ul>
<li>dateArg</li>
<li>fbdy</li>
<li>foreach</li>
<li>hello</li>
<li>today</li>
</ul>
<h1 id="a-brief-history-of-shell-commands">A Brief History of Shell
Commands</h1>
<p>:PROPERTIES: :CUSTOM_ID: a-brief-history-of-shell-commands :END:</p>
<p>In the first chapter, we composed one-line functions on the command
line. And promised more information on how to /compose simple functions
on the command line/. This exercise fulfills the promise. You will see
how using the command history makes it easy to create a shell function
from an often-used command.</p>
<p>A subsidiary objective of this chapter is to postpone the use of a
text editor on a file. If you are comfortable with any of the text
editors, by all means use your favorite. You will still gain something
from facility on the command line.</p>
<p>There is a short collection of composing functions on the command
line on my <a
href="https://www.youtube.com/channel/UCL-4038hJH6JTCJKoqunFuQ">YouTube
channel</a>. It should help to compose and edit functions onthe command
line.</p>
<p>No new functions are introduced in this chapter.</p>
<h2 id="new-concepts">New Concepts</h2>
<p>:PROPERTIES: :CUSTOM_ID: new-concepts :END:</p>
<ul>
<li>shell command history</li>
<li>identify two editor modes to edit command history</li>
<li>use command history numbers to recall a previous command</li>
<li>define a function by adding the function syntax, either by editing a
previously recovered command, or cutting and pasting a piece of history
with a mouse.</li>
</ul>
<p>To do this, you will walk thru some command history, navigating
forward and backward, finding a line and edit the line in your history
to turn it into a function.</p>
<h2 id="shell-command-history">Shell Command History</h2>
<p>:PROPERTIES: :CUSTOM_ID: shell-command-history :END: Here is an <a
href="https://www.youtube.com/watch?v=MbXofShhMv8">excellent
tutorial</a> on using the shell command history. ### Editor Modes
:PROPERTIES: :CUSTOM_ID: editor-modes :END: The shell has two
editor-based history modes, /vi/ and /emacs/ as well as keyboard
commands to navigate the shell history. To use the text editors for
shell history, you navigate with the editor’s line and inter-line
movement mechanisms.</p>
<p>You might reasonably ask at this point, “So, what’s with this editor
business? I thought we wouldn’t have to learn an editor.” Be assured,
it’s easier to navigate thru command history if you can handle the few
cursor movement commands the editor offers. Then editing a single line
is simply moving the cursor back and forth to insert or delete
characters.</p>
<p>To see all the available shell options use a <em>set -o</em> command.
Try that at your terminal window. Execute this command to see which your
current editor mode is set at:</p>
<p>#+begin_example $ set -o # shows all the options and their state $
set -o | grep -E ‘^(vi|emacs)’ # collect the edit modes emacs on vi off
$ #+end_example</p>
<p>This shows I am using the /emacs/ mode, which I prefer to /vi/ mode
or keyboard navigation. The editor modes toggle: if one is on, the other
is off. To set your preference, you might:</p>
<p>#+begin_example $ set -o vi #+end_example</p>
<p>to switch to the /vi/ mode. You may want to consult this cheat sheet
of editor modes: <a
href="http://www.catonmat.net/download/bash-history-cheat-sheet.txt">bashhist</a>.
If this is your first encounter withcommand history, I recommend vi
mode. Vi is a moded editor. After switching to vi mode, as above, and
inspecting the cheat sheet, the vi shortcuts are entered by preceding
the first command with the /escape/ “[esc]” on my keyboard, followed by
the letter from the table. Therefore to go back in history /[esc] k/.
The escape key toggles navigation while in vi mode. To continue back,
continue to strike the /k/ key; to go forward, the /j/. To stop
navigation, the /[esc]/ key.</p>
<h2 id="history-list">history list</h2>
<p>:PROPERTIES: :CUSTOM_ID: history-list :END: Recall your
<strong>useFunctionArguments</strong> experiment with the
<strong>dateArg</strong> function. Your first attempt was a simple date
command:</p>
<p>#+begin_example $ date +%F #+end_example</p>
<p>Here’s a piece of my recent shell history which shows how the command
may be turned into a function:</p>
<p>#+begin_example $ history | awk ‘$1 &gt; 616’</p>
<p>617 date +%F 618 date “+F: %F” 619 set F 620 date “+$1: %$1” 621 set
c 622 date “+$1: %$1” 623 history | awk ‘$2 ~ /date/’ 624 history | awk
‘$1 &gt; 590’ 625 history | awk ‘$1 &gt; 616’ $ #+end_example</p>
<p>How did I discover the line number to begin?</p>
<p>I’m looking for the date command, so the first attempt (my # 623) was
to identify all the uses of /date/. I thought I’d start at the reported
# 590, that proved to be more than I needed, so I settled on #614, which
was the latest bit of practice</p>
<p>Type the first three commands (617, 618, 619) at your terminal window
now. And do <em>not</em> type the line numbers. Since line number 619
sets the first <em>positional parameter</em> to the letter /F/, just as
it would be when passed to a function. You might try</p>
<p>#+begin_example $ echo $1 #+end_example</p>
<p>or, if you still have the /ea/ alias:</p>
<p>#+begin_example $ ea #+end_example</p>
<p>to verify that.</p>
<p>Then, on line 620, instead of typing the whole command, you may use
the history to recover your previous typing. In this case, the command
is quite brief; you could have typed it again from scratch. If you need
practice in your history, instead of typing 620 literally, do this:</p>
<ul>
<li><p>go back two commands, on my terminal, and maybe yours, the
up-arrow also works. In emacs mode, hit <em>[ctrl]P</em> to go back one,
in vi mode, hit <em>[esc]</em> to enter command mode, where <em>K</em>
goes back in history where <em>J</em> goes forward.</p></li>
<li><p>use line-editing commands, again the <em>delete</em> or backspace
keys may work. If you need more help, consult the cheat sheet
above.</p></li>
<li><p>change the literal /F/. to the shell variable /$1/ in both
instances, and then either /Enter/ or /Return/ to execute the
command.</p></li>
</ul>
<p>On line 621, change the first positional parameter to the lower-case
/c/, and re-execute the command by stepping back two lines in history to
line 807.</p>
<p>You can repeat that for as many letter options as you’d like. Also,
if you want to do any “out-of-bounds” testing, this is a good time to
try.</p>
<h2 id="the-simple-step-the-function">The simple step – the
function</h2>
<p>:PROPERTIES: :CUSTOM_ID: the-simple-step-the-function :END: With
command history, it is now quite simple to turn your recent efforts into
a function. All that is necessary is to wrap the latest command instance
with the function syntax, the most important part of which is a proper
name. As it’s possible to recall a history command by number, here is
how you might proceed:</p>
<p>#+begin_example $ !622 date “+$1: %$1” c: Mon Jul 1 09:58:20 2013 $
dateArg () { date “+$1: %$1”; } $ fbdy dateArg dateArg () { date “+$1:
%$1” } $ #+end_example</p>
<p>Where my history line number was 622. Inspect your history and
recover your command with the exclamation using the line-number or your
command. Now, rather than type the whole function definition /dateArg ()
{ … }/, simply retrieve the just-executed command by going back one line
in the history ( to the /date …/ command), but not re-execute it.</p>
<ul>
<li><p>Move to the beginning of the just-retrieved line in your history
buffer (i.e., do not hit the Enter key),</p></li>
<li><p>then enter the function name, parenthesis, and opening brace,
/dateArg () {/ In front of the function text,</p></li>
<li><p>and finally, go to the end of the line, and close with the
semi-colon and closing brace, /; }/.</p></li>
</ul>
<h2 id="terminal-cut-and-paste">Terminal Cut and Paste</h2>
<p>:PROPERTIES: :CUSTOM_ID: terminal-cut-and-paste :END: Should using
editor modes (vi or emacs) be a problem, your terminal should also offer
cut and paste from past history on the command line.</p>
<p>If that’s your preferred mode, then</p>
<ul>
<li><p>start the command by entering the leading text:</p>
<p>$ dateArg () {</p></li>
<li><p>then follow by cutting and pasting the command:</p>
<p>$ date “+$1: %$1”</p></li>
<li><p>which will appear:</p>
<p>$ dateArg () { date “+$1: %$1”</p></li>
<li><p>and close by entering the closing syntax:</p>
<p>$ ; }</p></li>
<li><p>yielding:</p>
<p>$ dateArg () { date “+$1: %$1”; }</p></li>
</ul>
<p>and you have your function. I recommend the editor modes. The time
investment will be repaid.</p>
<h2 id="review">Review</h2>
<p>:PROPERTIES: :CUSTOM_ID: review :END: - Assessment</p>
<ul>
<li><p>do you have a preferred editor mode, or do you prefer keyboard
navigation?</p></li>
<li><p>did you experiment with several options to the <em>date</em>
command?</p></li>
<li><p>in /inspectAfunctionBody/, did you refresh your experiment with
the /set –/ command?</p></li>
<li><p>Questions</p>
<ul>
<li><p>do you understand how the formatted <em>date</em> options
behave?</p></li>
<li><p>… how the /set –/ command works?</p></li>
</ul></li>
<li><p>/Did you understand the <em>history</em> command?/. The pipe to
<em>awk</em> is a little bonus?</p></li>
<li><p>/Did you succeed in creating the <em>dateArg</em>
function?/</p></li>
<li><p>/If not, can you assess where you got hung up?/</p></li>
<li><p>/Are you able to recall all the functions you have written?/ You
will learn this shortly.</p></li>
</ul>
<p>Here’s a sneak peak at one of the next facets:</p>
<p>#+begin_example $ gh () { history | grep -i ${*:-()}; }
#+end_example</p>
<p>What might you use it for?</p>
<h1 id="shdoc-shell-doc-comments">Shdoc – SHell DOC comments</h1>
<p>:PROPERTIES: :CUSTOM_ID: shdoc—-shell-doc-comments :END:</p>
<p>A few of the scripting and system programming languages have comment
conventions for their functions. <a
href="http://www.oracle.com/technetwork/java/javase/documentation/index-jsp-135444.html%5D%5BJavaDoc%5D%5D%20was%20possibly%20the%20earliestexample.%20Others%20instances%20are%20%5B%5Bhttps://en.wikipedia.org/wiki/Pydoc%5D%5Bpydoc%5D%5D,%20%5B%5Bhttp://perldoc.perl.org%5D%5Bperldoc%5D%5D,%20%5B%5Bhttps://en.wikipedia.org/wiki/YARD_(software)%5D%5BYARD%5D%5D,%20%5B%5Bhttps://en.wikipedia.org/wiki/RDoc%5D%5BRDOC%5D%5D,%20%5B%5Bhttps://en.wikipedia.org/wiki/Mkd_(software)">mkd</a>
,… and, in general, [sample][comparison].</p>
<p>As yet, there is no similar feature for the shell. This feature here
hopes to address that omission.</p>
<h2 id="new-concepts-1">New Concepts</h2>
<p>:PROPERTIES: :CUSTOM_ID: new-concepts :END:</p>
<p>This chapter sets a direction in documenting shell function features
and behavior.</p>
<ul>
<li>build on the /null command/</li>
<li>document a function, lessons learned from Java, Perl, Python …</li>
<li>each function should have an /abstract/</li>
<li>introduce a /tag/ concept</li>
<li>simple usage /example/</li>
<li>record modification times,</li>
<li>leading to a function database</li>
</ul>
<h2 id="the-null-command">the Null Command</h2>
<p>We will use the bash <a
href="https://www.shell-tips.com/bash/null-command">null command</a> for
our comment mechanism.There are a few caveats, which we’ll address
later.</p>
<p>/* $ set – test_comment_function; cat txt/$1; source txt/$1
test_comment_function () { # this is a sharp comment : this is a null
command comment : “you can’t use a (’) unless double quoted” }</p>
<p>$ declare -f $1 test_comment_function () { : this is a null command
comment; : “you can’t use a (’) unless double quoted” } $ */</p>
<p>This is the simplest demonstration of why we should use the null
command for our shell function comments. The /declare/ builtin has many
options. The <em>- p</em> option preserves the /null commands/ and
removes the /syntactic comments/.</p>
<p>We’ll save the warning messages for later, except to point out that
the single quote in one of these comments must be placed in double
quotes. Because of this behavior, I’m chosing to call the /declare -f
version/ of the function the <em>canonical</em> version of the function.
And if you look carefully at the first null command line, it now ends
with a semi-colon. This is because shell /commands/ need to be separated
with semi-colons. The last one need not be terminated with a semi-colon.
This is also true when typing multi-command functions on the command
line.</p>
<p>There are other things to note about the null command, some of which
we will take advantage of later.</p>
<p>Recall, the <em>fbdy</em> function is a shorthand for /declare -f/,
so we’ll continue to use the function.</p>
<h2 id="now-the-function-documentation">Now the Function
Documentation</h2>
<p>:PROPERTIES: :CUSTOM_ID: the-convention :END:</p>
<p>Since the <em>fbdy</em> function, using the /declare/ built-in, now
suppose the canonical format, it’s safe to use that as the conventional
layout of a function. Then, let’s adopt the convention as these other
languages do. Namely that</p>
<p>/The function API is the first comment lines after the
definition.//</p>
<h3 id="the-first-functions">the first functions</h3>
<p>:PROPERTIES: :CUSTOM_ID: the-first-functions :END: The first function
is =shd_justcolon=, using a few local utilities, and others which will
be described below.</p>
<p>#+begin_src shell :tangle ./src/ch03lib shd_justcolon () { : returns
leading colon-comments from a SINGLE function; : the section begins on
the third line of the canonical format : and ends when there are no more
null command lines fbdy $1 | awk ’ NR &gt; 2 { if ( $1 !~ /^:/ ) exit
else print } ’ } #+end_src</p>
<p>In a later chapter, we’ll cover why to use an underscore in a
function name.</p>
<p>/*</p>
<p>$ set – shd_justcolon; cat lib/$1; source lib/$1; comment $ $1 $1; $1
$1 shd_justcolon () { : returns leading colon-comments from a SINGLE
function; : the section begins on the third line of the canonical format
: and ends when there are no more null command lines fbdy $1 | awk ’ NR
&gt; 2 { if ( $1 !~ /^:/ ) exit else print } ’ } $ shd_justcolon
shd_justcolon : returns leading colon-comments from a SINGLE function; :
the section begins on the third line of the canonical format; : and ends
when there are no more null command lines; $ */</p>
<p>If this is your first introduction to awk, here is a <a
href="https://en.wikipedia.org/wiki/AWK">reference</a>. Briefly, awk
matches a /pattern/ and executes the /command/ on lines matching the
pattern</p>
<p>The pattern =NR &gt;2= matches any line after the 2nd, “Number of
Record greater than two”, the sequence 3, 4, …</p>
<p>The command says</p>
<ul>
<li>if the first token on the line does not start with a colon, then
exit awk,</li>
<li>else print the line</li>
</ul>
<p>So, print those first lines begining with a colon(:)</p>
<h3 id="comment-hide-some-functions-for-later">COMMENT Hide some
functions for later</h3>
<p>myname () { : ~ [n]; : returns name of caller OR callers caller …; :
date: 2018-02-16; echo <span
class="math inline">${FUNCNAME[$</span>{1:-1}]} } $ shdoc …</p>
<p>So, =shdoc= takes an indefinite number of arguments, defaulting to
itself, =myname=, calling =shd_each= for each of them. While it’s
tempting to use the wild-card properties of the /declare/ built-in, this
keeps the /awk/ code simpler.</p>
<p>The =report_notfunction= is part of the <em>report</em> family of
functions. These functions are built to report on /assertion
failures/.</p>
<p>And, lastly, the =myname= function, using the /bash/ built-in array,
FUNCNAME, returns the name of the calling function N levels up the
stack. It defaults to 1, returning the name of the immediate caller.</p>
<h2 id="embedding-a-modification-date">Embedding a Modification
Date</h2>
<p>:PROPERTIES: :CUSTOM_ID: utility-functions :END:</p>
<p>Let’s set and retrieve a date stamp in our functions.</p>
<p>#+include: lib/shd_setdate</p>
<p>#+include: lib/shd_getdate</p>
<p>#+include: lib/shd_latest</p>
<p>And an exercise to use the information:</p>
<p>/* $ foreach shd_latest shd_{{set,get}date,latest} 2022-01-02
shd_setdate 2022-08-25 shd_getdate 2022-03-23 shd_latest $ */</p>
<p>Last things first:</p>
<ul>
<li><em>shd_latest</em> retrieve the most recent modification date from
the list of date tags in the function</li>
<li><em>shd_getdate</em> retrieves all the date stamps for each function
argument</li>
<li><em>shd_setdate</em> adds today’s date as the last date in the
list</li>
</ul>
<p>Things to note about these functions:</p>
<ul>
<li>shd_setdate:</li>
</ul>
<p>the first four lines are the shell documentation, more later. the
oldest version is from 2016. the latest is on 2022-01-02. it uses an
/internal function/ =_dffx= while we’ll take up later it leaves the
updated function bodies in a temporary file and on /stdout/</p>
<ul>
<li>shd_getdate:</li>
</ul>
<p>reads each function, save its name in the =fun= variable when
encountering a date tag, prints the function and the whole tagline</p>
<ul>
<li>shd_latest</li>
</ul>
<p>since shd_getdate puts /functionname : date: yyyy-mm-dd/ the 4th
field is the date stamp is the 4th field it prints the value of the
=date= array and the index, the /function/ name.</p>
<h2 id="the-date-is-our-first-tag">The Date is Our First Tag</h2>
<p>Early in using the /date/ stamp, it became necessary to distinguish
the syntax from a routing /null command/. An early date stamp was =date
2016-06-09=.<br />
Examining the <em>shd_setdate</em> code you’ll see I took care to not
duplicate a date stamp and place the latest in the last line before any
code. Looking back also at the <em>shd_justcolon</em> code, you’ll see
it doesn’t account for any tags.</p>
<h3 id="the-shell-documentation">The Shell Documentation</h3>
<p>Based on our ability to extract leading-colon null comments from a
function, we can use that to produce the documentation for a function.
We’ll omit any tags, i.e. dates from the documentation, and adopt the
convention:</p>
<p>/the function’s <em>shdoc</em> precedes any <em>tag</em>/</p>
<p>A brief demonstration of shdoc: /*</p>
<p>foreach xx shd_setdate shd_getdate shd_latest shdoc; fbdy shdoc</p>
<p>*/</p>
<p>where <em>xx</em> is a throw-away function, used to make the
/foreach/ easy to represent.</p>
<p>/* xx () { echo; echo $1; shdoc $1; } */</p>
<pre><code>shd_setdate
appends date tag to functions shdoc -- this -- block,
returning updated function body
avoiding redundancy, as last line among leading shdoc comments
this uses the local function trick. trailing UNSET

shd_getdate
collect date-stamps from functions, by args

shd_latest
retrieve the last date tag in each function

shdoc
this is a shell &quot;shdoc&quot; comment
an shdoc comment is the first un-tagged &quot;:&quot;-origin lines
in the shell function, the rest being the executable.</code></pre>
<p>/* shdoc () { : this is a shell “shdoc” comment; : an shdoc comment
is the first un-tagged “:”-origin lines; : in the shell function, the
rest being the executable.; : date: 2018-02-16; : date: 2022-11-05;
declare -f ${1:-shdoc} | shd_justcolon | awk ’</p>
<pre><code>    $2 ~ /.*:/ { exit };
           {
         sub(/: /,&quot;&quot;);
         sub(/ *; */,&quot;&quot;)
         print
           }&#39;
}</code></pre>
<p>*/</p>
<p>Things to note:</p>
<ul>
<li>the <em>shdoc</em> function’s /shdoc/ only captures the the lines
preceding the /date/ tag.</li>
<li>the <em>xx</em> function, meant to be a throw-away is a good way
set-up a <em>foreach</em> loop</li>
</ul>
<p>Since each /shdoc/ may take multiple lines, we can call the first
line the /abstract/. An abstract makes a lot of sense in distinguishing
behavior’s of a group of functions operating on similar objects.</p>
<p>**** COMMENT retrieve find_orgfuns</p>
<h3 id="functions-abstracts">Functions Abstracts</h3>
<h2 id="building-the-function-database">Building the Function
Database</h2>
<h3 id="functions-yet-to-define">Functions yet to define</h3>
<p>This list of functions are called in the hierarchy of the =shd_=
functions we’ve just defined.</p>
<p>/*</p>
<p>debug func_args if_missingargs isfunction myname report_notargcount
report_usage</p>
<p>*/</p>
<h2 id="awk-digression">awk digression</h2>
<p>:PROPERTIES: :CUSTOM_ID: awk-digression :END: This is our first
encounter with the <em>awk</em> programming language. It’s too useful in
shell environments to not have brief mention in an application such as
this.</p>
<p>, <em>Do this:</em> Read the <a
href="https://en.wikipedia.org/wiki/AWK">main article</a>. For our
purpose, an awk script is made up of /pattern { action }/ pairs.</p>
<p>In its one use here, in the function =_shdoc=, the built-in /declare
-f/ puts the function body on the standard output to =shd_justcolon=
using <a href="https://en.wikipedia.org/wiki/AWK">awk</a>, with its only
pattern=NR &gt; 2=, works on every line after the second, printing those
lines which begin a colon (:). The script exits when the first
non-leading colon is encountered.</p>
<p>The =_shdoc= function adds the leading and trailing context. It may
all have been done in awk.</p>
<p>The purpose of this exercise is to show the complementary nature of
awk to the shell. It is much easier to read and understand the awk code
than the equivalent shell expressions for the task. There’s no clear
standard, but you will find a line between data-processing using
<em>awk</em> and manipulating system objects, files, directories, and
their relationships using the <em>shell</em> .</p>
<h2 id="activity">Activity</h2>
<p>:PROPERTIES: :CUSTOM_ID: activity :END: 1. write a shell function,
using awk to print function names from function definitions on the
either the standard input or from named files. (hint: use the =cat
${*:–}= idiom and think, “what syntax identifies a function name?” in
the text)</p>
<ol start="2" type="1">
<li>add sufficient <em>shdoc</em> to the function. does it need much
more than the requirements in the activity request?</li>
</ol>
<h2 id="references-1">References</h2>
<p>:PROPERTIES: :CUSTOM_ID: references :END: 1. <a
href="https://en.wikipedia.org/wiki/AWK">awk</a> – pattern matching,
execution language 2. <a
href="https://en.wikipedia.org/wiki/Comparison_of_documentation_generators">comparison</a>
– comparison of documentation generators 3. <a
href="http://www.oracle.com/technetwork/java/javase/documentation/index-jsp-135444.html">javadoc</a>
– how to document java function definitions 4. <a
href="https://en.wikipedia.org/wiki/Mkd_(software)%5D%5Bmkd%5D%5D5.%20%5B%5Bhttp://perldoc.perl.org">perldoc</a>
– how do document perl functions 6. <a
href="https://en.wikipedia.org/wiki/Pydoc">pydoc</a> – how do document
python functions 7. <a
href="https://en.wikipedia.org/wiki/RDoc%5D%5BRDOC%5D%5D8.%20%5B%5Bhttps://en.wikipedia.org/wiki/YARD_(software)">YARD</a>
–*** COMMENT New Functions :PROPERTIES: :CUSTOM_ID: new-functions :END:
- myname - what is the name of my calling function - report_notfunction
- report if not called by it’s argument - report_notpipe - report if
standard input is not on a pipe - report_usage - used by reporting
functions - shdoc - _shdoc over a list of functions - _shdoc – supplies
output function format for colon-comments - shd_justcolon – returns
leading colon comments</p>
<p>**** - shell array FUNCNAME - which function called this function</p>
<h1 id="collecting-functions">Collecting Functions</h1>
<h2 id="families">Families</h2>
<h3 id="names">names</h3>
<h3 id="generic-sub-functions-e.g.-_init">generic sub-functions,
e.g. _init</h3>
<h2 id="types-of-libraries">Types of Libraries</h2>
<h3 id="system-low-level">system, low-level</h3>
<pre><code>- debug
- report</code></pre>
<h3 id="application-oriented">application oriented</h3>
<h3 id="collection-plate">collection plate</h3>
<h2 id="collecting-into-applications">Collecting into Applications</h2>
<h1 id="assertion-checking">Assertion checking</h1>
<p>Functions being called with arguments may anticipate, and check to
see if the arguments</p>
<ul>
<li>have a miniumum number of arguments</li>
<li>whose specifc arguments are files, or functions</li>
<li>match a certain pattern, or type: alphanumeric, interger,
decimal,</li>
<li>be conditional based on prior arguments.</li>
</ul>
<h1 id="development-process">Development Process</h1>
<h2 id="using-backup">using Backup</h2>
<h2 id="how-frequently-take-a-version">how frequently take a
“version”</h2>
<h2 id="shdoc-tags-prep-for-function-data-base">shdoc, tags, prep for
Function Data base</h2>
<h2 id="dp-cycle-in-one-principle-library-with-others">DP, Cycle in One
Principle library, with others</h2>
<h1 id="debugging">Debugging</h1>
<h1 id="dot-prof-the-dp-command">Dot Prof, the DP command</h1>
<p>The =dp= function, as a command, routinely <em>source</em>’s a
/.prof/ file. It also</p>
<ul>
<li>supplies a default /.prof/ file, to temporarily support
development,</li>
<li>is where new shell functions are composed</li>
<li>existing functions are updated,</li>
<li>test cases are written and run, and</li>
<li>it provides means to return functions to their individual home
libraries and likely different ones.</li>
</ul>
<p>Since the .prof file may have as many functions as the developer
cares to be working on at once, it’s not unlikely, while many may be in
a single library, others may be distributed. Recall the development
model is to work down to system level interfaces and features and up
towards applications</p>
<h2 id="sections-of-the-dot-prof-file.">Sections of the Dot Prof
file.</h2>
<h3 id="sources">sources</h3>
<p>If libraries are being updated, they should first be sourced in the
.prof file, since they have functions later in the file, this guarantees
all the library functions current versions, including any being
updated.</p>
<h3 id="functions-2">functions</h3>
<p>The default /.prof/ needn’t have any functions supplied. At the
moment, it has a semantic <em>comment</em> function. Rather than the
syntactic sharp sign:</p>
<div class="line-block"># this is the usual shell comment</div>
<p>I prefer what I call the semantic comment, a function:</p>
<p>/*</p>
<p>comment ( ) { : put arguments on the standard output echo $@
1&gt;&amp;2 : or alternatively, simply : return }</p>
<p>Also make sure you’ve read and understood the use of [[null command
comments]].</p>
<p>*/</p>
<h2 id="top-functions">Top Functions</h2>
<p>The =dp= function supplies an existing /.prof/, which the developer
writes new and edits functions.</p>
<p>The =qf= function, for Quick Fix saves existing named functions in
the /.qf/ which may be read into the /.prof/</p>
<p>The =dp_status= function gives a four-part report on the status of
function development.</p>
<h3 id="solo">Solo</h3>
<p>The section lists the new functions, those which aren’t yet in a
library. These functions may have a preferred library based on their
users, who they use.</p>
<p>A function to return one or more functions to a library:</p>
<p>/*</p>
<p>funslib $(which preferredlib) new_function{a,b,c}</p>
<p>*/</p>
<h3 id="home">Home</h3>
<p>This area lists the function name and and its home library as
arguments to a function =dp_diff= which compares (via the <em>diff</em>
command) the /.prof/ and home library (the current) version.</p>
<p>For example:</p>
<p>/* $dp_diff dfg_duplibs
/Users/martymcgowan/Dropbox/marty3/bin/dfglib</p>
<p>1c1 &lt; ./.prof — &gt; /Users/martymcgowan/Dropbox/marty3/bin/dfglib
7 43 264 .prof.out 7 43 302 .lib.out 14 86 566 total</p>
<p>*/</p>
<p>Any differences are highlight by the leading <em>&lt;</em> and
<em>&gt;</em>. In this case the <em>wc</em> – word count output of the
two copies, listing lines words and characers, differing on in the
character count, the /lib/ total exceeding the /prof/ total by the
difference in the length of the respective names.</p>
<p>Another example highlighting the difference:</p>
<p>/* $ dp_diff rdupdate
/Users/martymcgowan/Dropbox/marty3/bin/functionlib</p>
<p>1c1 &lt; ./.prof — &gt;
/Users/martymcgowan/Dropbox/marty3/bin/functionlib 7a8,12 &gt; : date:
2021-10-04; &gt; … &gt; : date: 2022-04-09; 12c17,19 &lt; pushd <span
class="math inline"><em>d</em><em>i</em><em>r</em>2 &gt; /<em>d</em><em>e</em><em>v</em>/<em>n</em><em>u</em><em>l</em><em>l</em>;  −  −  −  &gt; <em>l</em><em>o</em><em>c</em><em>a</em><em>l</em><em>t</em><em>b</em><em>l</em>=</span>(basename
$1); &gt; debug A dir: $dir, tbl: $tbl; &gt; runfrom $dir $tbl ||
return; 41,44c48 &lt; … &lt; pushd 2&gt; /dev/null; &lt; cdx 2&gt;
/dev/null; &lt; … — &gt; doit backup $tbl 45 163 1218 .prof.out 49 181
1392 .lib.out 94 344 2610 total</p>
<p>*/</p>
<p>The existing =&gt; … /functionlib= copy shows some date tags,
inconsequential to the function’s behaviour, and three statements, a
local variable, a =debug= statment, and a =runfrom= command. These have
been replaced in the =&lt; ./.prof= copy, by a wordier replacement, a
paired =pushd= arrangment, the first to the explicit directory, the
latter =pushd= without an argument swaps the items on the stack, and the
terminal =cdx= clears duplicate entries. This defends against the first
pushd to the current directory, which duplicates that directory on the
stack</p>
<h2 id="used-functions">Used Functions</h2>
<p>/*</p>
<p>*/</p>
<h1 id="a-database-for-functions">A Database for Functions</h1>
<p>This arose quite late in my shell functions practice. Imagine a dozen
libraries, living in scattered =bin= dinrectories. And in suffix-less
files with a common *lib at the end of the name. e.g. functionlib,
commonlib, … With a population of over a thousand functions, it seemed
useful to be able to query the lot for attributes, text, operators,
certain syntax, …</p>
<p>At first I was tempted to store attributes in /RDB tables. That
proved to be more work than was necessary. My decision was to unpack
libraries with from a few functions to hundreds each, into a directory
structure where each function was stored in a file, each directory the
name of the library (or .profile) where the function is defined.</p>
<p>Before you ask, the answer is “yes”, it is possible for a function to
be defined in more than one place. Enter the family name. Where many
libraries may need an /libname/=_init= function, the names may retain
their unique name. Those functions of a completely generic nature will
have to be unique in the entire namespace. And it’s possible that two
libraries may define an identically named function. At the moment, I’ve
just under 30 functions defined in more than one library.</p>
<p>I’ve made it relatively easy to move a function from one library to
another, or to decide which library is the more appropriate home for any
function with multiple defining libraries.</p>
<p>Before heading further, if you’ve not read at least the introduction
to Function Tags, do that now.</p>
<h2 id="the-architecture">the Architecture</h2>
<p>The function databaw3</p>
<h2 id="access">Access</h2>
<h3 id="adding-to-the-database">adding to the database</h3>
<h3 id="removing-from-the-databas">removing from the databas</h3>
<h3 id="querying-the-database">querying the database</h3>
<h1 id="factor-a-shell-script">Factor a Shell Script</h1>
<h1 id="system-tools">System Tools</h1>
<h2 id="awk">Awk</h2>
<h3 id="in-functions-size-objective">in functions, size objective</h3>
<h2 id="sed-grep">Sed, Grep</h2>
<h1 id="applications">Applications</h1>
<h2 id="rdb">/RDB</h2>
<h2 id="backup">Backup</h2>
<h2 id="tags">Tags</h2>
<h2 id="function-data-base">Function Data Base</h2>
<h1 id="comment-the-invariants">COMMENT The Invariants</h1>
<h2 id="a-place-to-collect-the-short-separated">A place to collect the
short, separated</h2>
<ul>
<li>e.g. functions live in ./bin/*lib files</li>
<li>libraries don’t execute their _init, it’s the user’s profile’s
job</li>
<li>sourcing a library may not write on <strong>stdout</strong></li>
</ul>
<h2 id="shibboleth-rebuttal">shibboleth rebuttal</h2>
<ul>
<li>//sh-bang// is hardly ever needed</li>
<li>instances of:
<ul>
<li>cat //stuff// pipe to filter is a fair alternative, consider grep
side-effect</li>
<li>so-called efficiencies in thousands of milliseconds are demolished
by Moore’s law</li>
</ul></li>
</ul>
<p>/*</p>
<pre><code>cat ${@:--} | command ....  versus  command .... ${@:--} </code></pre>
<p>*/</p>
<h2 id="publication-plans">publication plans</h2>
<ul>
<li>when this goes public, Chapter 1, plus the TOC stays free to the
public</li>
<li>not without a means of collecting for the whole copy, and with
graphic drop</li>
</ul>
<h3
id="todo-resurrect-the-2107-edition-of-m_c_wagon-to-mcorg-eschew-wp">TODO
resurrect the 2107 edition of m_c_wagon to McOrg, eschew WP</h3>
<h1 id="appendices">Appendices</h1>
<h2 id="the-script">The Script</h2>
<h3 id="the-app_script">the app_script</h3>
<h3 id="an-actual-sh-bang">an actual sh-bang</h3>
<h3 id="the-only-sh-bang-youll-ever-need">the only sh-bang you’ll ever
need</h3>
<p>https://mcgowans.org/pubs/marty3/commonplace/software/onlyOneShBang.html</p>
</body>
</html>
